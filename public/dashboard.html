<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Socya - Sistema de Planificación</title>
    <link rel="stylesheet" href="../src/App.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <link rel="stylesheet" href="../libs/gridstack.min.css" />
    <link rel="stylesheet" href="../src/styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  </head>
  <body>
    <template id="sidebar-template">
      <nav class="sidebar-menu">
        <a href="./dashboard.html" class="sidebar-item" data-page="dashboard"><span class="sidebar-icon" data-lucide="layout-dashboard"></span><span>Dashboards</span></a>
        <a href="./index.html" class="sidebar-item" data-page="planning"><span class="sidebar-icon" data-lucide="calendar"></span><span>Planificación</span></a>
        <a href="https://drive.google.com/file/d/1sG94XW0CLRHV3pqKZxALqc8Q4Pq2EnRA/view" class="sidebar-item" target="_blank" rel="noopener"><span class="sidebar-icon" data-lucide="file-text"></span><span>Manual Interactivo</span></a>
        <a href="https://drive.google.com/file/d/1YnlgdMOOAyz80l8D66bHhvPe0jNTkq5W/view" class="sidebar-item" target="_blank" rel="noopener"><span class="sidebar-icon" data-lucide="shield"></span><span>Política de seguridad</span></a>
        <a href="#" class="sidebar-item" data-page="documents"><span class="sidebar-icon" data-lucide="folder-open"></span><span>Documentos de operaciones TI</span></a>
        
      </nav>
    </template>

    <template id="header-template">
      <p class="welcome-text">Bienvenido a la mesa de ayuda, Juan</p>
      <img src="../img/Usuario1.png" alt="Ilustración" class="welcome-figure" />
    </template>

    <template id="planning-template">
      <div class="planning-layout">
        <div class="calendar-section"><div id="calendar-root"></div></div>
        <div class="tasks-section"><div id="tasks-root"></div></div>
      </div>
      
      
    </template>

    <template id="dashboards-template">


      <div class="grid-stack"></div>
      <section id="edit-view" class="edit-view" aria-label="Editar configuración" role="region"></section>

      <div id="chartModal" class="modal" hidden>
        <div class="modal-backdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
          <div class="modal-header">
            <h2 id="modalTitle">Información de la gráfica</h2>
            <div class="modal-header-actions">
              <button type="button" id="modalClose" class="modal-close" aria-label="Cerrar"><span data-lucide="x"></span></button>
            </div>
          </div>
          <div class="modal-controls">
            <div class="group">
              <label for="modalCategory">Tipo:</label>
              <select id="modalCategory">
                <option value="tendencias">Tendencias temporales</option>
                <option value="kpi">KPI / Valores únicos</option>
                <option value="volumenes">Volúmenes / Conteos</option>
                <option value="ranking">Comparación por responsable / ranking</option>
                <option value="distribucion">Distribución por tipo / efectividad por área</option>
                <option value="multivariables">Métricas compuestas / multivariables</option>
                <option value="satisfaccion">Satisfacción / Evaluaciones</option>
              </select>
            </div>
            <div class="group">
              <span id="modalTypeLabel" class="type-badge" aria-live="polite">Tipo de gráfica: —</span>
            </div>
            <button type="button" id="modalClearBtn" class="modal-clear-btn">Limpiar dashboard</button>
          </div>
          <div class="modal-content">
            <div class="modal-chart">
              <canvas id="modalChartCanvas"></canvas>
              <button type="button" id="modalPrev" class="modal-arrow left" aria-label="Anterior">‹</button>
              <button type="button" id="modalNext" class="modal-arrow right" aria-label="Siguiente">›</button>
            </div>
            <div class="modal-stats">
              <div id="modalStats"></div>
              <table id="modalDataTable"></table>
            </div>
          </div>
          <div class="modal-actions">
            <button type="button" id="modalAddBtn">Agregar</button>
          </div>
        </div>
        <div id="confirmDeleteOverlay" class="confirm-overlay" hidden>
          <div class="confirm-box" role="alertdialog" aria-labelledby="confirmDeleteTitle" aria-describedby="confirmDeleteDesc">
            <h3 id="confirmDeleteTitle">Confirmar eliminación</h3>
            <p id="confirmDeleteDesc">¿Está seguro que desea eliminar esta gráfica?</p>
            <div class="confirm-actions">
              <button type="button" id="confirmCancelBtn" class="confirm-cancel">Cancelar</button>
              <button type="button" id="confirmDeleteBtn" class="confirm-danger">Confirmar</button>
            </div>
          </div>
        </div>
      </div>

      <div id="catalogModal" class="modal" hidden>
        <div class="modal-backdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="catalogTitle">
          <div class="modal-header">
            <h2 id="catalogTitle">Agregar gráficas</h2>
            <div class="modal-header-actions">
              <button type="button" id="catalogClose" class="modal-close" aria-label="Cerrar"><span data-lucide="x"></span></button>
            </div>
          </div>
          <div class="modal-controls">
            <div class="group">
              <button type="button" id="catalogDetailsBtn" class="modal-add-btn" aria-label="Ver detalles">Detalles</button>
              <button type="button" id="catalogBackBtn" class="modal-secondary-btn" aria-label="Volver al catálogo" hidden>Volver</button>
              <button type="button" id="catalogFilterToggle" class="filter-toggle" aria-label="Abrir filtros">Filtrar</button>
              <span id="catalogFilterIndicator" class="filter-indicator" aria-live="polite"></span>
              <div id="catalogFilterDropdown" class="filter-dropdown" hidden>
                <div class="filter-section">
                  <label class="filter-label">Tipo de dato</label>
                  <ul id="catalogDataTypeList" class="filter-list"></ul>
                </div>
                <div class="filter-section">
                  <label class="filter-label">Tipos de gráfica</label>
                  <ul id="catalogChartTypeList" class="filter-list multi"></ul>
                </div>
                <div class="filter-actions">
                  <button type="button" id="catalogFilterResetBtn" class="modal-secondary-btn">Restablecer</button>
                  <button type="button" id="catalogFilterApplyBtn" class="modal-add-btn">Aplicar</button>
                </div>
              </div>
            </div>
            <div class="group" style="margin-left:auto; gap:8px;">
              <button type="button" id="catalogConfirmBtn" class="modal-add-btn">Agregar seleccionados</button>
              <button type="button" id="catalogClearBtn" class="modal-clear-btn">Limpiar dashboard</button>
            </div>
          </div>
          <div class="modal-content">
            <div id="catalogGrid" class="view catalog-grid" aria-live="polite" role="region" aria-label="Catálogo de widgets"></div>
            <div id="catalogDetailsView" class="view catalog-details" role="region" aria-label="Detalles de la gráfica" tabindex="-1" hidden>
              <div class="details-header">
                <h3 id="catalogDetailsTitle">Detalles</h3>
                <p id="catalogDetailsType" class="details-subtitle">Tipo de gráfica seleccionado</p>
              </div>
              <div class="details-chart">
                <canvas id="catalogDetailsCanvas" aria-describedby="catalogDetailsTitle"></canvas>
                <button type="button" id="catalogPrev" class="modal-arrow left" aria-label="Anterior">‹</button>
                <button type="button" id="catalogNext" class="modal-arrow right" aria-label="Siguiente">›</button>
              </div>
              <div class="details-stats">
                <div id="catalogDetailsStats" class="stats-grid" aria-live="polite"></div>
                <table id="catalogDetailsTable" aria-label="Resumen de datos"></table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="requestsModal" class="modal" hidden>
        <div class="modal-backdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="requestsTitle">
          <div class="modal-header">
            <h2 id="requestsTitle">Peticiones</h2>
            <div class="modal-header-actions">
              <button type="button" id="requestsClose" class="modal-close" aria-label="Cerrar"><span data-lucide="x"></span></button>
            </div>
          </div>
          <div class="modal-content">
            <div class="requests-container" id="requestsContainer">
              <div class="requests-filters"><div class="filters-row"><button id="rqFilterMy" class="tab-btn" type="button">Mis Peticiones</button><div class="filters-closed"><button id="rqFilterClosedAll" class="tab-btn" type="button">Todos cerrados</button><button id="rqFilterClosedMine" class="tab-btn" type="button">Mis cerradas</button></div><div class="search-input-wrap"><input id="requestsSearchInput" type="text" placeholder="Buscar" aria-label="Buscar peticiones" autocomplete="off" /><ul id="requestsSearchSuggestions" class="search-suggestions" hidden aria-label="Sugerencias"></ul></div></div></div>
              <div id="requestsListPanel" class="requests-panel">
                <ul id="requestsList" class="requests-list" aria-live="polite" aria-label="Lista de peticiones"></ul>
              </div>
              <div id="requestDetailsPanel" class="requests-panel details" hidden aria-hidden="true" aria-labelledby="requestDetailsTitle" role="region">
                <div class="details-header">
                  <h3 id="requestDetailsTitle">Detalle de petición</h3>
                  <nav class="details-breadcrumb" aria-label="Miga de pan">
                    <span>Peticiones</span><span class="sep">›</span><span>Detalle</span>
                  </nav>
                  <button type="button" id="requestDetailsBack" class="modal-secondary-btn" aria-label="Volver a la lista">Volver</button>
                </div>
                <div id="requestDetailsContent" class="details-content" aria-live="polite"></div>
              </div>
              <div id="requestNewPanel" class="requests-panel details" hidden aria-hidden="true" aria-labelledby="requestNewTitle" role="region">
                <div class="details-header">
                  <h3 id="requestNewTitle">Nueva petición</h3>
                  <nav class="details-breadcrumb" aria-label="Miga de pan">
                    <span>Peticiones</span><span class="sep">›</span><span>Nueva</span>
                  </nav>
                  <div class="details-actions">
                    <button type="button" id="requestNewCancel" class="modal-secondary-btn" aria-label="Cancelar">Cancelar</button>
                    <button type="button" id="requestNewSave" class="modal-add-btn" aria-label="Guardar">Guardar</button>
                  </div>
                </div>
                <div id="requestNewContent" class="details-content" aria-live="polite">
                  <div id="requestNewStatus" class="form-status" aria-live="polite"></div>
                  <form id="requestNewForm" class="request-form" aria-label="Formulario de nueva petición">
                    <section class="details-section" aria-labelledby="sec-contact">
                      <div class="details-title" id="sec-contact">Información de contacto</div>
                      <div class="form-grid">
                        <div class="field"><label for="reqNewUser">Usuario<span aria-hidden="true">*</span></label><input id="reqNewUser" type="text" aria-required="true" /><div class="error-text" id="errUser"></div></div>
                        <div class="field"><label for="reqNewEmail">E‑mail<span aria-hidden="true">*</span></label><input id="reqNewEmail" type="email" placeholder="@socya.org.co" aria-required="true" /><div class="error-text" id="errEmail"></div></div>
                        <div class="field"><label for="reqNewDept">Departamento<span aria-hidden="true">*</span></label><select id="reqNewDept" aria-required="true"><option value="">Seleccione</option><option>Marketing</option><option>Compras</option><option>Diseño</option><option>TI</option><option>RRHH</option></select><div class="error-text" id="errDept"></div></div>
                        <div class="field"><label for="reqNewLocation">Ubicación</label><input id="reqNewLocation" type="text" /><div class="error-text" id="errLocation"></div></div>
                        <div class="field"><label for="reqNewPhone">Teléfono</label><input id="reqNewPhone" type="tel" /><div class="error-text" id="errPhone"></div></div>
                      </div>
                    </section>
                    <section class="details-section" aria-labelledby="sec-class">
                      <div class="details-title" id="sec-class">Clasificación</div>
                      <div class="form-grid">
                        <div class="field"><label for="reqNewCategory">Categoría<span aria-hidden="true">*</span></label><select id="reqNewCategory" aria-required="true"><option value="">Seleccione</option><option>General</option><option>Soporte</option><option>Finanzas</option><option>Operaciones</option></select><div class="error-text" id="errCategory"></div></div>
                        <div class="field"><label for="reqNewStatus">Estado<span aria-hidden="true">*</span></label><select id="reqNewStatus" aria-required="true"><option value="">Seleccione</option><option>Solicitado</option><option>En curso</option><option>Bloqueado</option><option>Culminado</option><option>Bajo revisión</option></select><div class="error-text" id="errStatus"></div></div>
                        <div class="field"><label for="reqNewPriority">Prioridad<span aria-hidden="true">*</span></label><select id="reqNewPriority" aria-required="true"><option value="">Seleccione</option><option>Baja</option><option>Media</option><option>Alta</option><option>Crítica</option></select><div class="error-text" id="errPriority"></div></div>
                        <div class="field"><label for="reqNewAssign">Asignar a<span aria-hidden="true">*</span></label><select id="reqNewAssign" aria-required="true"><option value="">Seleccione</option><option>Hernando Antonio</option><option>Rafael Urbina</option><option>Equipo de TI</option></select><div class="error-text" id="errAssign"></div></div>
                        <div class="field"><label for="reqNewTime">Tiempo invertido (minutos)</label><input id="reqNewTime" type="number" min="0" step="1" value="0" /><div class="error-text" id="errTime"></div></div>
                      </div>
                    </section>
                    <section class="details-section" aria-labelledby="sec-problem">
                      <div class="details-title" id="sec-problem">Información del problema</div>
                      <div class="field"><label for="reqNewDescription">Descripción<span aria-hidden="true">*</span></label><textarea id="reqNewDescription" rows="6" aria-required="true" placeholder="Describe el problema"></textarea><div class="error-text" id="errDescription"></div></div>
                    </section>
                    <section class="details-section" aria-labelledby="sec-files">
                      <div class="details-title" id="sec-files">Adjuntos</div>
                      <div class="field">
                        <input id="reqNewFiles" type="file" multiple />
                        <div class="file-hint">Formatos: .docx, .doc, .odt, .rtf, .xlsx, .xls, .csv, .xlsm, .ods, .pdf, .jpg, .jpeg, .png, .gif, .webp, .tiff, .tif, .svg. Máx por archivo: 10MB, total: 50MB.</div>
                        <ul id="reqNewFileList" class="file-list" aria-live="polite"></ul>
                        <div class="error-text" id="errFiles"></div>
                      </div>
                    </section>
                    <section class="details-section" aria-label="Confirmación">
                      <div class="field"><label class="checkbox-row"><input id="reqNewConfirm" type="checkbox" /> <span>No enviar correo al usuario</span></label><div class="error-text" id="errConfirm"></div></div>
                    </section>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="chatbotModal" class="modal" hidden>
        <div class="modal-backdrop"></div>
        <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="chatbotTitle">
          <div class="modal-header">
            <h2 id="chatbotTitle">Asistente</h2>
            <div class="modal-header-actions">
              <button type="button" id="chatbotClose" class="modal-close" aria-label="Cerrar"><span data-lucide="x"></span></button>
            </div>
          </div>
          <div class="modal-content">
            <div id="chatHistory" class="chat-history" aria-live="polite" role="region" aria-label="Historial de chat"></div>
            <form id="chatForm" class="chat-input-row" aria-label="Enviar mensaje">
              <input id="chatMessageInput" type="text" placeholder="Escribe tu mensaje" aria-label="Mensaje" />
              <button type="submit" id="chatSendBtn" class="modal-add-btn" aria-label="Enviar">Enviar</button>
            </form>
          </div>
        </div>
      </div>
    </template>

    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script>window.global = window;</script>
    <script src="../libs/gridstack-all.js?v=20241125-1"></script>
    <script src="../libs/chart.umd.js?v=20241125-1"></script>
    <script src="../src/menu.js?v=20241125-1"></script>
    <script src="../src/app.js?v=20241125-1"></script>
    <script src="../src/main.js?v=20241125-1"></script>
    <script src="../src/fab.js?v=20241125-1"></script>
  </body>
</html>
